{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/index.js","public/js/stripe.js","public/js/login.js","public/js/updateSettings.js","public/js/updatePassword.js"],"sourcesContent":["export const createMap = (locationsData) => {\r\n\r\n  console.log('fdf')\r\n\r\n  const map = L.map('map', {\r\n    center: [31.111745, -118.113491],\r\n    zoom: 16,\r\n    minZoom: 3,\r\n    worldCopyJump: true\r\n  });\r\n  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    maxZoom: 19,\r\n    attribution:\r\n      '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\r\n  }).addTo(map);\r\n\r\n  const markerArray = [];\r\n  locationsData.forEach((loc) => {\r\n    const reversedArr = [...loc.coordinates].reverse();\r\n\r\n    const myIcon = L.icon({\r\n      iconUrl: './../img/pin.png',\r\n      iconSize: [30, 35],\r\n      iconAnchor: [15, 35]\r\n    });\r\n\r\n    L.marker(reversedArr, { icon: myIcon }).addTo(map).bindPopup(`<p >Day ${loc.day}: ${loc.description}</p>`, {\r\n      autoClose: false,\r\n      className: 'mapPopup'\r\n    });\r\n    markerArray.push(reversedArr);\r\n  });\r\n  const bounds = L.latLngBounds(markerArray);\r\n  map.fitBounds(bounds);\r\n\r\n};\r\n\r\n","export const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\nexport const showAlert = (type, message) => {\r\n  hideAlert();\r\n  const markup = `<div class='alert alert--${type}'>${message}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  setTimeout(() => hideAlert(), 5000);\r\n};\r\n\r\n","import { createMap } from './mapbox.js';\r\nimport { login, logout } from './login.js';\r\nimport { updateSettings } from './updateSettings.js';\r\nimport { updatePassword } from './updatePassword.js';\r\nimport { bookTour } from './stripe.js';\r\n\r\nconst map = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-settings');\r\nconst bookBtn = document.getElementById('books-tour');\r\n\r\nif (map) {\r\n  const locationsData = JSON.parse(document.getElementById('map').dataset.location);\r\n  createMap(locationsData);\r\n}\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login({ email, password });\r\n  });\r\n}\r\n\r\nif (logOutBtn) {\r\n  logOutBtn.addEventListener('click', logout);\r\n}\r\n\r\nif (userDataForm) {\r\n  userDataForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    const formData = new FormData();\r\n    formData.append('name', document.getElementById('name').value);\r\n    formData.append('email', document.getElementById('email').value);\r\n    formData.append('photo', document.getElementById('photo').files[0]);\r\n\r\n    const newImage = await updateSettings(formData)\r\n\r\n    if (newImage) {\r\n      document.querySelector('.nav__user-img')\r\n        .setAttribute('src', `/img/users/${newImage.data.data.user.photo}`);\r\n      document.querySelector('.form__user-photo')\r\n        .setAttribute('src', `/img/users/${newImage.data.data.user.photo}`);\r\n    }\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n    await updatePassword(passwordCurrent, password, passwordConfirm);\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n\r\n  });\r\n}\r\n\r\nif(bookBtn) {\r\n  bookBtn.addEventListener('click', e => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n\r\n}","const stripe = Stripe('pk_test_51MlDhLCjjVsEhy3P7KO6pOiVMAxsZc1wYFTKYjL4Fl27m8cZE8C6dRh7VYxU1HVKTxgF521QQFiCPnQQZHdbFtpH00886oPDS3');\r\nimport { showAlert } from './alerts.js';\r\n\r\nconst bookingBtn = document.getElementById('books-tour');\r\n\r\nexport const bookTour = async tourId => {\r\n  try {\r\n    const session = await axios.get(`/api/v1/booking/checkout-session/${tourId}`);\r\n\r\n    console.log(session)\r\n\r\n    window.location.replace(session.data.session.url);\r\n  } catch (err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n\r\n\r\n\r\n","import { showAlert } from './alerts.js';\r\n\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios.get('/api/v1/users/logout');\r\n    if (res.data.status === 'success') {\r\n      window.setTimeout(() => {\r\n        showAlert('success', 'Logged out successfully!');\r\n        location.assign('/');\r\n      }, 1500);\r\n    } else {\r\n      location.reload(true);\r\n    }\r\n    return res;\r\n  } catch (e) {\r\n    showAlert('error', e.response.data.message);\r\n  }\r\n};\r\n\r\n\r\nexport const login = async (loginData) => {\r\n  try {\r\n    const res = await axios.post('/api/v1/users/login', loginData);\r\n\r\n    if (res.data.status === 'success') {\r\n      window.setTimeout(() => {\r\n        showAlert('success', 'Logged in successfully!');\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n    return res;\r\n  } catch (e) {\r\n    showAlert('error', e.response.data.message);\r\n  }\r\n};\r\n\r\n","import { showAlert } from './alerts.js';\r\n\r\n\r\nexport const updateSettings = async (data) => {\r\n  try {\r\n    const res = await axios.patch('/api/v1/users/updateMyData', data);\r\n\r\n    if (res.data.status === 'success') {\r\n      window.setTimeout(() => {\r\n        showAlert('success', 'User successfully updated');\r\n      }, 1500);\r\n    }\r\n    return res;\r\n  } catch (e) {\r\n    setTimeout(() => {\r\n      showAlert('error', e.response.data.message);\r\n    });\r\n  }\r\n};\r\n\r\n","import { showAlert } from './alerts.js';\r\n\r\nexport const updatePassword = async (passwordCurrent, password, passwordConfirm) => {\r\n  try {\r\n    const data = {\r\n      passwordCurrent,\r\n      password,\r\n      passwordConfirm\r\n    };\r\n\r\n    const res = await axios.patch('/api/v1/users/updateMyPassword', data);\r\n\r\n    if (res.data.status === 'success') {\r\n      window.setTimeout(() => {\r\n        showAlert('success', 'Password successfully updated');\r\n      }, 1500);\r\n    }\r\n\r\n    return res;\r\n  } catch (e) {\r\n    window.setTimeout(() => {\r\n      showAlert('error', e.response.data.message);\r\n    }, 1500);\r\n  }\r\n};\r\n\r\n"],"names":["$b01db4da9d111652$export$5a81baf3e1f8b5bb","el","document","querySelector","parentElement","removeChild","$b01db4da9d111652$export$e2ed28791945543d","type","message","markup","insertAdjacentHTML","setTimeout","$e90d12d35cb48c24$var$map","Stripe","getElementById","$e90d12d35cb48c24$var$loginForm","$e90d12d35cb48c24$var$logOutBtn","$e90d12d35cb48c24$var$userDataForm","$e90d12d35cb48c24$var$userPasswordForm","$e90d12d35cb48c24$var$bookBtn","locationsData","console","log","map","L","center","zoom","minZoom","worldCopyJump","tileLayer","maxZoom","attribution","addTo","markerArray","forEach","loc","reversedArr","coordinates","reverse","myIcon","icon","iconUrl","iconSize","iconAnchor","marker","bindPopup","day","description","autoClose","className","push","bounds","latLngBounds","fitBounds","$1c25fba746cc31ee$export$678c831020942d51","JSON","parse","dataset","location","addEventListener","e","preventDefault","async","loginData","res","axios","post","data","status","window","assign","response","$212ec473d5bf09c9$export$4a142f624dd0fa8","value","get","reload","formData","FormData","append","files","newImage","patch","$baec1ded6f001e5d$export$81acc09c7bdb4525","setAttribute","user","photo","textContent","passwordCurrent","password","passwordConfirm","$492ff2847841f623$export$85bc0ca5fa683d22","target","tourId","session","replace","url","err","$5b30c8a71ad7f90c$export$54ca10ceadf03905"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}