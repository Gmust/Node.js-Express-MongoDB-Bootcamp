const e=()=>{const e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},t=(t,s)=>{e();const o=`<div class='alert alert--${t}'>${s}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",o),setTimeout((()=>e()),5e3)},s=(Stripe("pk_test_51MlDhLCjjVsEhy3P7KO6pOiVMAxsZc1wYFTKYjL4Fl27m8cZE8C6dRh7VYxU1HVKTxgF521QQFiCPnQQZHdbFtpH00886oPDS3"),document.getElementById("books-tour"),document.getElementById("map")),o=document.querySelector(".form--login"),a=document.querySelector(".nav__el--logout"),n=document.querySelector(".form-user-data"),r=document.querySelector(".form-user-settings"),c=document.getElementById("books-tour");if(s){(e=>{console.log("fdf");const t=L.map("map",{center:[31.111745,-118.113491],zoom:16,minZoom:3,worldCopyJump:!0});L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(t);const s=[];e.forEach((e=>{const o=[...e.coordinates].reverse(),a=L.icon({iconUrl:"./../img/pin.png",iconSize:[30,35],iconAnchor:[15,35]});L.marker(o,{icon:a}).addTo(t).bindPopup(`<p >Day ${e.day}: ${e.description}</p>`,{autoClose:!1,className:"mapPopup"}),s.push(o)}));const o=L.latLngBounds(s);t.fitBounds(o)})(JSON.parse(document.getElementById("map").dataset.location))}o&&o.addEventListener("submit",(e=>{e.preventDefault();(async e=>{try{const s=await axios.post("/api/v1/users/login",e);return"success"===s.data.status&&window.setTimeout((()=>{t("success","Logged in successfully!"),location.assign("/")}),1500),s}catch(e){t("error",e.response.data.message)}})({email:document.getElementById("email").value,password:document.getElementById("password").value})})),a&&a.addEventListener("click",(async()=>{try{const e=await axios.get("/api/v1/users/logout");return"success"===e.data.status?window.setTimeout((()=>{t("success","Logged out successfully!"),location.assign("/")}),1500):location.reload(!0),e}catch(e){t("error",e.response.data.message)}})),n&&n.addEventListener("submit",(async e=>{e.preventDefault();const s=new FormData;s.append("name",document.getElementById("name").value),s.append("email",document.getElementById("email").value),s.append("photo",document.getElementById("photo").files[0]);const o=await(async e=>{try{const s=await axios.patch("/api/v1/users/updateMyData",e);return"success"===s.data.status&&window.setTimeout((()=>{t("success","User successfully updated")}),1500),s}catch(e){setTimeout((()=>{t("error",e.response.data.message)}))}})(s);o&&(document.querySelector(".nav__user-img").setAttribute("src",`/img/users/${o.data.data.user.photo}`),document.querySelector(".form__user-photo").setAttribute("src",`/img/users/${o.data.data.user.photo}`))})),r&&r.addEventListener("submit",(async e=>{e.preventDefault(),document.querySelector(".btn--save-password").textContent="Updating...";const s=document.getElementById("password-current").value,o=document.getElementById("password").value,a=document.getElementById("password-confirm").value;await(async(e,s,o)=>{try{const a={passwordCurrent:e,password:s,passwordConfirm:o},n=await axios.patch("/api/v1/users/updateMyPassword",a);return"success"===n.data.status&&window.setTimeout((()=>{t("success","Password successfully updated")}),1500),n}catch(e){window.setTimeout((()=>{t("error",e.response.data.message)}),1500)}})(s,o,a),document.querySelector(".btn--save-password").textContent="Save password",document.getElementById("password-current").value="",document.getElementById("password").value="",document.getElementById("password-confirm").value=""})),c&&c.addEventListener("click",(e=>{e.target.textContent="Processing...";const{tourId:s}=e.target.dataset;(async e=>{try{const t=await axios.get(`/api/v1/booking/checkout-session/${e}`);console.log(t),window.location.replace(t.data.session.url)}catch(e){console.log(e),t("error",e)}})(s)}));const d=document.querySelector("body").dataset.alert;d&&t("success",d);
//# sourceMappingURL=index.js.map
